{
  "nodes": [
    {
      "nodeId": "userGuide",
      "name": "common:core.module.template.system_config",
      "intro": "common:core.module.template.system_config_info",
      "avatar": "core/workflow/template/systemConfig",
      "flowNodeType": "userGuide",
      "position": {
        "x": 262.2732338817093,
        "y": -476.00241136598146
      },
      "version": "481",
      "inputs": [
        {
          "key": "welcomeText",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "string",
          "label": "core.app.Welcome Text",
          "value": ""
        },
        {
          "key": "variables",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "core.app.Chat Variable",
          "value": []
        },
        {
          "key": "questionGuide",
          "valueType": "any",
          "renderTypeList": [
            "hidden"
          ],
          "label": "core.app.Question Guide",
          "value": {
            "open": false
          }
        },
        {
          "key": "tts",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "value": {
            "type": "web"
          }
        },
        {
          "key": "whisper",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "value": {
            "open": false,
            "autoSend": false,
            "autoTTSResponse": false
          }
        },
        {
          "key": "scheduleTrigger",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "value": null
        }
      ],
      "outputs": []
    },
    {
      "nodeId": "448745",
      "name": "common:core.module.template.work_start",
      "intro": "",
      "avatar": "core/workflow/template/workflowStart",
      "flowNodeType": "workflowStart",
      "position": {
        "x": 891.6679353701977,
        "y": -347.7446492944009
      },
      "version": "481",
      "inputs": [
        {
          "key": "userChatInput",
          "renderTypeList": [
            "reference",
            "textarea"
          ],
          "valueType": "string",
          "label": "workflow:user_question",
          "required": true,
          "toolDescription": "用户问题",
          "debugLabel": ""
        }
      ],
      "outputs": [
        {
          "id": "userChatInput",
          "key": "userChatInput",
          "label": "common:core.module.input.label.user question",
          "type": "static",
          "valueType": "string",
          "description": ""
        }
      ]
    },
    {
      "nodeId": "hbxhhZgxEInlelvm",
      "name": "批量执行",
      "intro": "输入一个数组，遍历数组并将每一个数组元素作为输入元素，执行工作流。",
      "avatar": "core/workflow/template/loop",
      "flowNodeType": "loop",
      "showStatus": true,
      "position": {
        "x": 1345,
        "y": -1061
      },
      "inputs": [
        {
          "key": "loopInputArray",
          "renderTypeList": [
            "reference"
          ],
          "valueType": "arrayString",
          "required": true,
          "label": "workflow:loop_input_array",
          "value": [
            [
              "VARIABLE_NODE_ID",
              "mBlAVtk7"
            ]
          ],
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "childrenNodeIdList",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "arrayString",
          "label": "",
          "value": [
            "yStkmsrDQSgpD1yg",
            "h1rgjjvFlgJvBVnz",
            "jWVlsQPGQTcmqhlU",
            "qBBnWBa8O2xuBQ0b"
          ]
        },
        {
          "key": "nodeWidth",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "number",
          "label": "",
          "value": 2315.676800557405
        },
        {
          "key": "nodeHeight",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "number",
          "label": "",
          "value": 1319
        },
        {
          "key": "loopNodeInputHeight",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "number",
          "label": "",
          "value": 83,
          "debugLabel": "",
          "toolDescription": ""
        }
      ],
      "outputs": [
        {
          "id": "loopArray",
          "key": "loopArray",
          "label": "workflow:loop_result",
          "type": "static",
          "valueType": "arrayString",
          "valueDesc": "",
          "description": ""
        }
      ]
    },
    {
      "nodeId": "yStkmsrDQSgpD1yg",
      "parentNodeId": "hbxhhZgxEInlelvm",
      "name": "开始",
      "avatar": "core/workflow/template/loopStart",
      "flowNodeType": "loopStart",
      "showStatus": false,
      "position": {
        "x": 1415.4538261856533,
        "y": -545.4746629394047
      },
      "inputs": [
        {
          "key": "loopStartInput",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "any",
          "label": "",
          "required": true,
          "value": "",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "loopStartIndex",
          "renderTypeList": [
            "hidden"
          ],
          "valueType": "number",
          "label": "workflow:Array_element_index",
          "debugLabel": "",
          "toolDescription": ""
        }
      ],
      "outputs": [
        {
          "id": "loopStartIndex",
          "key": "loopStartIndex",
          "label": "workflow:Array_element_index",
          "type": "static",
          "valueType": "number",
          "description": ""
        },
        {
          "id": "loopStartInput",
          "key": "loopStartInput",
          "label": "数组元素",
          "type": "static",
          "valueType": "string"
        }
      ]
    },
    {
      "nodeId": "h1rgjjvFlgJvBVnz",
      "parentNodeId": "hbxhhZgxEInlelvm",
      "name": "结束",
      "avatar": "core/workflow/template/loopEnd",
      "flowNodeType": "loopEnd",
      "showStatus": false,
      "position": {
        "x": 3231.130626743058,
        "y": -349.47466293940465
      },
      "inputs": [
        {
          "key": "loopEndInput",
          "renderTypeList": [
            "reference"
          ],
          "valueType": "any",
          "label": "",
          "required": true,
          "value": [
            "qBBnWBa8O2xuBQ0b",
            "answerText"
          ],
          "debugLabel": "",
          "toolDescription": ""
        }
      ],
      "outputs": []
    },
    {
      "nodeId": "jWVlsQPGQTcmqhlU",
      "parentNodeId": "hbxhhZgxEInlelvm",
      "name": "网页内容抓取",
      "intro": "可获取一个网页链接内容，并以 Markdown 格式输出，仅支持获取静态网站。",
      "avatar": "core/workflow/template/fetchUrl",
      "flowNodeType": "tool",
      "showStatus": true,
      "position": {
        "x": 1915.988867316229,
        "y": -545.4746629394047
      },
      "version": "",
      "inputs": [
        {
          "renderTypeList": [
            "reference",
            "input"
          ],
          "selectedTypeIndex": 0,
          "valueType": "string",
          "key": "url",
          "label": "url",
          "description": "需要读取的网页链接",
          "required": true,
          "toolDescription": "需要读取的网页链接",
          "value": [
            "yStkmsrDQSgpD1yg",
            "loopStartInput"
          ]
        }
      ],
      "outputs": [
        {
          "valueType": "string",
          "key": "result",
          "label": "result",
          "description": "获取的网页内容",
          "type": "static",
          "id": "result"
        },
        {
          "id": "system_error_text",
          "key": "system_error_text",
          "type": "error",
          "valueType": "string",
          "label": "workflow:error_text"
        }
      ],
      "pluginId": "systemTool-fetchUrl",
      "toolConfig": {
        "systemTool": {
          "toolId": "systemTool-fetchUrl"
        }
      },
      "catchError": false
    },
    {
      "nodeId": "qBBnWBa8O2xuBQ0b",
      "parentNodeId": "hbxhhZgxEInlelvm",
      "name": "AI 对话",
      "intro": "AI 大模型对话",
      "avatar": "core/workflow/template/aiChat",
      "flowNodeType": "chatNode",
      "showStatus": true,
      "position": {
        "x": 2525.93985085118,
        "y": -738.1565209489468
      },
      "version": "4.9.7",
      "inputs": [
        {
          "key": "model",
          "renderTypeList": [
            "settingLLMModel",
            "reference"
          ],
          "label": "common:core.module.input.label.aiModel",
          "valueType": "string",
          "value": "doubao-seed-1-6-250615",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "temperature",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "number",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "maxToken",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "number",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "isResponseAnswerText",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "value": false,
          "valueType": "boolean",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "aiChatQuoteRole",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "string",
          "value": "system",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "quoteTemplate",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "string",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "quotePrompt",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "string",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "aiChatVision",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "boolean",
          "value": false,
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "aiChatReasoning",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "boolean",
          "value": false,
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "aiChatTopP",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "number",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "aiChatStopSign",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "string",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "aiChatResponseFormat",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "string",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "aiChatJsonSchema",
          "renderTypeList": [
            "hidden"
          ],
          "label": "",
          "valueType": "string",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "systemPrompt",
          "renderTypeList": [
            "textarea",
            "reference"
          ],
          "max": 3000,
          "valueType": "string",
          "label": "common:core.ai.Prompt",
          "description": "common:core.app.tip.systemPromptTip",
          "placeholder": "common:core.app.tip.chatNodeSystemPromptTip",
          "value": "Role: 知识库内容对比分析专家\n\nBackground: 用户需要对外部知识库内容与论文总结进行精确对比，识别出论文总结中缺失但存在于原始知识库的内容，并要求严格忠于原文进行输出保留。\n\nAttention: 必须确保所有输出内容完全来源于外部知识库原文，可以添加必要的解释、推断或总结性内容， 确保可读性。\n\nProfile: 你是一位严谨的内容对比专家，擅长精确识别文本差异，具有出色的原文保持能力和细节捕捉能力。\n\nSkills:\n1. 精确识别外部知识库内容与论文总结之间的差异点\n2. 严格遵循原文内容，保持文本忠实度\n3. 具备深入的文本分析能力，能够发现细微的内容差异\n4. 熟练掌握对比分析方法，确保不遗漏任何关键信息\n5. 拥有出色的细节观察能力，能够捕捉到容易被忽略的内容差异\n\nGoals:\n1. 全面对比外部知识库内容与提供的论文总结\n2. 准确识别论文总结中不存在但存在于知识库的内容部分\n3. 严格保持原文内容完整性，不进行任何修改或编辑\n4. 确保所有输出内容都直接来源于知识库原文\n5. 提供清晰、准确的内容差异识别结果\n\nWorkflow:\n1. 接收用户提供的外部知识库内容和论文总结文本\n2. 逐段对比知识库内容与论文总结的对应部分\n3. 识别并标记论文总结中不存在但知识库中包含的内容\n4. 提取这些差异内容，保持原文的完整表述\n5. 以结构化格式输出所有识别出的缺失内容部分\n\nOutputFormat:\n1. 使用清晰的标题标识每个缺失内容部分\n2. 保持原文的段落结构和格式完整性",
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "history",
          "renderTypeList": [
            "numberInput",
            "reference"
          ],
          "valueType": "chatHistory",
          "label": "common:core.module.input.label.chat history",
          "description": "workflow:max_dialog_rounds",
          "required": true,
          "min": 0,
          "max": 50,
          "value": 6,
          "debugLabel": "",
          "toolDescription": ""
        },
        {
          "key": "quoteQA",
          "renderTypeList": [
            "settingDatasetQuotePrompt"
          ],
          "label": "",
          "debugLabel": "知识库引用",
          "valueType": "datasetQuote",
          "description": "",
          "toolDescription": ""
        },
        {
          "key": "fileUrlList",
          "renderTypeList": [
            "reference",
            "input"
          ],
          "label": "app:workflow.user_file_input",
          "debugLabel": "文件链接",
          "description": "app:workflow.user_file_input_desc",
          "valueType": "arrayString",
          "value": [
            [
              "448745",
              "userFiles"
            ]
          ],
          "toolDescription": ""
        },
        {
          "key": "userChatInput",
          "renderTypeList": [
            "reference",
            "textarea"
          ],
          "valueType": "string",
          "label": "workflow:user_question",
          "toolDescription": "用户问题",
          "required": true,
          "value": "【论文总结】{{$448745.userChatInput$}}\n【外部知识库内容】{{$jWVlsQPGQTcmqhlU.result$}}",
          "selectedTypeIndex": 1,
          "debugLabel": ""
        }
      ],
      "outputs": [
        {
          "id": "history",
          "key": "history",
          "required": true,
          "label": "common:core.module.output.label.New context",
          "description": "将本次回复内容拼接上历史记录，作为新的上下文返回",
          "valueType": "chatHistory",
          "valueDesc": "{\n  obj: System | Human | AI;\n  value: string;\n}[]",
          "type": "static"
        },
        {
          "id": "answerText",
          "key": "answerText",
          "required": true,
          "label": "common:core.module.output.label.Ai response content",
          "description": "将在 stream 回复完毕后触发",
          "valueType": "string",
          "type": "static",
          "valueDesc": ""
        },
        {
          "id": "reasoningText",
          "key": "reasoningText",
          "required": false,
          "label": "workflow:reasoning_text",
          "valueType": "string",
          "type": "static",
          "invalid": false,
          "valueDesc": "",
          "description": ""
        },
        {
          "id": "system_error_text",
          "key": "system_error_text",
          "type": "error",
          "valueType": "string",
          "label": "workflow:error_text",
          "valueDesc": "",
          "description": ""
        }
      ],
      "catchError": false
    },
    {
      "nodeId": "uEjwbBcYQ6NEHCIB",
      "name": "文本拼接",
      "intro": "可对固定或传入的文本进行加工后输出，非字符串类型数据最终会转成字符串类型。",
      "avatar": "core/workflow/template/textConcat",
      "flowNodeType": "textEditor",
      "position": {
        "x": 3806.8364460600833,
        "y": -635.2158097477655
      },
      "inputs": [
        {
          "key": "system_textareaInput",
          "renderTypeList": [
            "textarea"
          ],
          "valueType": "string",
          "required": true,
          "label": "workflow:concatenation_text",
          "placeholder": "workflow:input_variable_list",
          "value": "{{$hbxhhZgxEInlelvm.loopArray$}}",
          "debugLabel": "",
          "toolDescription": ""
        }
      ],
      "outputs": [
        {
          "id": "system_text",
          "key": "system_text",
          "label": "workflow:concatenation_result",
          "type": "static",
          "valueType": "string",
          "valueDesc": "",
          "description": ""
        }
      ]
    },
    {
      "nodeId": "m2r4R2IuGtPo80Ui",
      "name": "指定回复",
      "intro": "该模块可以直接回复一段指定的内容。常用于引导、提示。非字符串内容传入时，会转成字符串进行输出。",
      "avatar": "core/workflow/template/reply",
      "flowNodeType": "answerNode",
      "position": {
        "x": 4468.836446060083,
        "y": -635.2158097477655
      },
      "inputs": [
        {
          "key": "text",
          "renderTypeList": [
            "textarea",
            "reference"
          ],
          "valueType": "any",
          "required": true,
          "label": "common:core.module.input.label.Response content",
          "description": "common:core.module.input.description.Response content",
          "placeholder": "common:core.module.input.description.Response content",
          "value": "{{$uEjwbBcYQ6NEHCIB.system_text$}}",
          "debugLabel": "",
          "toolDescription": ""
        }
      ],
      "outputs": []
    }
  ],
  "edges": [
    {
      "source": "448745",
      "target": "hbxhhZgxEInlelvm",
      "sourceHandle": "448745-source-right",
      "targetHandle": "hbxhhZgxEInlelvm-target-left"
    },
    {
      "source": "yStkmsrDQSgpD1yg",
      "target": "jWVlsQPGQTcmqhlU",
      "sourceHandle": "yStkmsrDQSgpD1yg-source-right",
      "targetHandle": "jWVlsQPGQTcmqhlU-target-left"
    },
    {
      "source": "jWVlsQPGQTcmqhlU",
      "target": "qBBnWBa8O2xuBQ0b",
      "sourceHandle": "jWVlsQPGQTcmqhlU-source-right",
      "targetHandle": "qBBnWBa8O2xuBQ0b-target-left"
    },
    {
      "source": "qBBnWBa8O2xuBQ0b",
      "target": "h1rgjjvFlgJvBVnz",
      "sourceHandle": "qBBnWBa8O2xuBQ0b-source-right",
      "targetHandle": "h1rgjjvFlgJvBVnz-target-left"
    },
    {
      "source": "hbxhhZgxEInlelvm",
      "target": "uEjwbBcYQ6NEHCIB",
      "sourceHandle": "hbxhhZgxEInlelvm-source-right",
      "targetHandle": "uEjwbBcYQ6NEHCIB-target-left"
    },
    {
      "source": "uEjwbBcYQ6NEHCIB",
      "target": "m2r4R2IuGtPo80Ui",
      "sourceHandle": "uEjwbBcYQ6NEHCIB-source-right",
      "targetHandle": "m2r4R2IuGtPo80Ui-target-left"
    }
  ],
  "chatConfig": {
    "variables": [
      {
        "key": "mBlAVtk7",
        "label": "url_ls",
        "type": "custom",
        "description": "",
        "required": false,
        "valueType": "arrayString",
        "defaultValue": ""
      }
    ],
    "scheduledTriggerConfig": {
      "cronString": "",
      "timezone": "Asia/Shanghai",
      "defaultPrompt": ""
    },
    "_id": "68c558445749f574d2841e55"
  }
}